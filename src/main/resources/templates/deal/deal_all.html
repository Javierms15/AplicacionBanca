<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}"/>
	<title>Menu Deal</title>
    <meta charset="UTF-8"/>
</head>

<body>

<header th:replace="layout/layout :: header"></header>

<a th:href="@{/deal/create}" class="btn btn-info btn-xs">Nuevo deal</a>

<div class="container py-4">
    <div class="card bg-dark text-white">

        <div class="card-header" style="font-size: xx-large">Filtrar</div>

        <div class="card-body">

            <form th:action="@{/deal}" th:object="${filter}" method="post">

                <div class="row mb-3">
                    <label class="col-sm-2 col-form-label">Estado:</label>
					<div class="col-sm-10">
                    <select class="form-control" th:field="*{estado}">
                        <option value="">---</option>
                        <option value="PENDING">Pending</option>
                        <option value="APPROVED">Approved</option>
                        <option value="CLOSED">Closed</option>
                    </select>
					</div>
                </div>

                <div class="row mb-3">
                    <label class="col-sm-2 col-form-label">Moneda:</label>
					<div class="col-sm-10">
                    <select class="form-control" th:field="*{moneda}">
                        <option value="">---</option>
                        <option value="EUR">Euro</option>
                        <option value="USD">Dolar estadounidense</option>
                        <option value="JPY">Yen</option>
                        <option value="GBP">Libra</option>
                    </select>
					</div>
                </div>

                <div class="row mb-3">
                    <label class="col-sm-2 col-form-label">Tipo:</label>
					<div class="col-sm-10">
                    <select class="form-control" th:field="*{tipo}">
                        <option value="">---</option>
                        <option value="SOLE_LENDER">Sole lender</option>
                        <option value="SYNDICATED">Syndicated</option>
                    </select>
					</div>
                </div>

                <div class="row mb-3">
                    <label class="col-sm-2 col-form-label">Cantidad Prestamo:</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" th:field="*{cantidadPrestamo}" pattern="^\d*(\.\d{1,2})?$"
						title="Solo se permiten números con hasta 2 decimales" />
					</div>
                </div>

                <div class="row mb-3">
                    <label class="col-sm-2 col-form-label">Cantidad Abonada:</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" th:field="*{cantidadAbonada}" pattern="^\d*(\.\d{1,2})?$"
						title="Solo se permiten números con hasta 2 decimales" />
					</div>
                </div>

                <div class="row mb-3">
                    <label class="col-sm-2 col-form-label">Cantidad A Pagar:</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" th:field="*{cantidadAPagar}" pattern="^\d*(\.\d{1,2})?$"
						title="Solo se permiten números con hasta 2 decimales" />
					</div>
                </div>

                <div class="row mb-3">
                    <label class="col-sm-2 col-form-label">Descuento:</label>
					<div class="col-sm-10">
						<select class="form-control" th:field="*{descuento}">
							<option value="">---</option>
							<option value="0">No</option>
							<option value="1">SI</option>
						</select>
					</div>
                </div>

                <div class="row mb-3">
                    <label class="col-sm-2 col-form-label">Cliente:</label>
					<div class="col-sm-10">
						<select class="form-control" th:field="*{cliente}">
							<option value="">---</option>
							<option th:each="cliente: ${clientes}" th:value="${cliente.idCliente}" th:text="${cliente.nombreLegal}">
							</option>
						</select>
					</div>
                </div>

                <div class="form-group row">
                    <div class="col-sm-6">
                        <input type="submit" class="btn btn-secondary" value="Filtrar"/>
                    </div>
                </div>
            </form>
        </div>

    </div>
</div>

<div class="container py-4">
    <div class="card bg-light">

        <div class="card-header" style="font-size: xx-large">Listado de Deals</div>

        <table class="table table-striped table-bordered">
            <thead class="thead-inverse">
            <tr>
                <td>ID</td>
                <td>Estado</td>
                <td>Cantidad prestamo</td>
                <td>Cantidad abonada</td>
                <td>Cantidad a pagar</td>
                <td>Moneda</td>
                <td>Tipo</td>
                <td>Descuento</td>
                <td>Cliente</td>
            </tr>
            </thead>
            <tbody>
            <tr th:each="deal: ${deals}">
                <td th:text="${deal.idDeal}"></td>
                <td th:text="${deal.estado}"></td>
                <td th:text="${deal.cantidadPrestamo}"></td>
                <td th:text="${deal.cantidadAbonada}"></td>
                <td th:text="${deal.cantidadAPagar}"></td>
                <td th:text="${deal.moneda}"></td>
                <td th:text="${deal.tipo}"></td>
                <td th:text="${deal.descuento == 0 ? 'NO' : 'SI'}"></td>
				<td th:each="cliente: ${clientes}" th:if="${deal.cliente == cliente.idCliente}"
					th:text="${cliente.nombreLegal}"></td>
                <td><a th:href="@{/deal/edit/} + ${deal.idDeal}" class="btn btn-info btn-xs">Editar</a></td>
                <td><a th:href="@{/deal/delete/} + ${deal.idDeal}" class="btn btn-danger btn-xs">Borrar</a></td>
            </tr>
            </tbody>
        </table>

    </div>
</div>
</body>

</html>