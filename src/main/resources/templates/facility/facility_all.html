<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}"/>
    <meta charset="UTF-8">
    <title>Lista Facility</title>
</head>
<body>

<header th:replace="layout/layout :: header"></header>


    <form th:action="@{/filtrarFacility}" th:object="${filter}" method="post">
        <div>
            <label>Tipo:</label>
            <select class="form-control" th:field="*{tipo}">
                <option value="">---</option>
                <option value="TERM">Term</option>
                <option value="REVOLVER">Revolver</option>
            </select>
        </div>
        <div>
            <label>Estado:</label>
            <select class="form-control" th:field="*{estado}">
                <option value="">---</option>
                <option value="PENDING">Pending</option>
                <option value="APPROVED">Approved</option>
                <option value="CLOSED">Closed</option>
            </select>
        </div>
        <div>
            <label>Cantidad:</label>
            <input type="text" class="form-control" th:field="*{cantidad}" pattern="^\d*(\.\d{1,2})?$" title="Solo se permiten números con hasta 2 decimales" />
        </div>
        <div>
            <label>Fecha de creación:</label>
            <input type="date" class="form-control" th:field="*{fechaCreacion}" />
        </div>
        <div>
            <label>Fecha efectiva:</label>
            <input type="date" class="form-control" th:field="*{fechaEfectiva}" />
        </div>
        <div>
            <label>Fecha de finalización:</label>
            <input type="date" class="form-control" th:field="*{fechaFinalizacion}" />
        </div>
        <div th:if="${session.usuario.rol == 'ADMIN'}">
            <label>Deal:</label>
            <select  th:field="*{deal}">
                <option value="">---</option>
                <option th:each="deal: ${deals}" th:value="${deal.idDeal}" th:itemid="${deal.idDeal}" th:text="${deal.idDeal}"></option>
            </select><br>
        </div>

        <div class="form-group row">
            <div class="col-sm-6">
                <input type="submit" class="btn btn-secondary" value="Filtrar" />
            </div>
        </div>
    </form>


<table th:if="${!facilitys.isEmpty}">
    <thead>
    <tr>
        <td>ID</td>
        <td>Tipo</td>
        <td>Estado</td>
        <td>Cantidad</td>
        <td>Fecha Creación</td>
        <td>Fecha Efectiva</td>
        <td>Fecha Finalización</td>
        <td>Deal</td>
    </tr>
    </thead>
    <tbody>
    <tr th:each="facility: ${facilitys}">
        <td th:text="${facility.idFacility}"></td>
        <td th:text="${facility.tipo}"></td>
        <td th:text="${facility.estado}"></td>
        <td th:text="${facility.cantidad}"></td>
        <td th:text="${facility.fechaCreacion}"></td>
        <td th:text="${facility.fechaEfectiva}"></td>
        <td th:text="${facility.fechaFinalizacion}"></td>
        <td th:text="${facility.deal}"></td>
        <td><a th:href="@{editarFacility/} + ${facility.idFacility}" th:text="Editar"></a></td>
        <td><a th:href="@{eliminarFacility/} + ${facility.idFacility}" th:text="Eliminar"></a></td>

    </tr>
    </tbody>
</table>

<p th:if="${facilitys.isEmpty}">No existen </p>

<form action="/nuevaFacility">
    <button type="submit">Nueva facility</button>
</form>
</body>
</html>